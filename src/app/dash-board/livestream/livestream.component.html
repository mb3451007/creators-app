<div class="livestream-container p-4">
  <h1 class="text-center mb-4">Live Streaming</h1>

  <!-- Video Containers -->
  <div *ngIf="userData.role === 'creator'" class="video-container-wrapper mb-3">
    <div id="local-video" class="video-container rounded-3 shadow"></div>
  </div>
  <div
    *ngIf="userData.role !== 'creator' && streamJoined"
    class="video-container-wrapper mb-3"
  >
    <div id="remote-video" class="video-container rounded-3 shadow"></div>
  </div>

  <!-- Active Streams Section for Subscribers -->
  <div
    *ngIf="userData.role === 'subscriber'"
    class="stream-list col-lg-8 col-md-10 mx-auto mb-4"
  >
    <div
      *ngIf="activeStreams.length > 0 && !streamJoined"
      class="available-streams text-center p-3 rounded bg-light shadow"
    >
      Live Streams Available
    </div>
    <div
      *ngIf="activeStreams.length === 0"
      class="no-streams text-center p-3 rounded bg-light shadow"
    >
      No Streams Available
    </div>

    <div *ngIf="activeStreams.length > 0 && !streamJoined">
      <div
        *ngFor="let stream of activeStreams"
        class="stream-item p-3 mb-3 d-flex align-items-center justify-content-between rounded shadow"
      >
        <div class="creator-info d-flex align-items-center">
          <div class="profile-img me-3">
            <img
              [src]="getMediaUrl(stream.creator.profile)"
              alt="Profile Image"
              class="rounded-circle"
              width="50"
              height="50"
            />
          </div>
          <div class="creator-details">
            <div class="creator-name fw-bold">{{ stream.creator.name }}</div>
            <div class="creator-username text-muted">
              @{{ stream.creator.username }}
            </div>
          </div>
        </div>
        <div>
          <button
            (click)="joinStream(stream)"
            class="join-btn px-4 py-2 bg-primary text-light rounded"
          >
            Join Now
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Action Buttons for Creator and Subscriber -->
  <div class="stream-actions text-center mt-3">
    <button
      *ngIf="userData.role === 'creator' && streamStarted"
      class="stop-btn bg-danger text-light px-4 py-2 rounded me-2"
      (click)="ngOnDestroy()"
    >
      Stop Stream
    </button>
    <button
      *ngIf="userData.role === 'subscriber' && streamJoined"
      class="leave-btn bg-danger text-light px-4 py-2 rounded me-2"
      (click)="ngOnDestroy()"
    >
      Leave Stream
    </button>
    <button
      *ngIf="userData.role === 'creator' && !streamStarted"
      class="start-btn bg-success text-light px-4 py-2 rounded me-2"
      (click)="startStream()"
    >
      Start Stream
    </button>
    <button
      *ngIf="userData.role === 'creator' && streamStarted"
      class="audio-toggle-btn bg-secondary text-light px-4 py-2 rounded me-2"
      (click)="toggleAudio()"
    >
      {{ isAudioMuted ? "Unmute" : "Mute" }}
    </button>
    <button
      *ngIf="userData.role === 'creator' && streamStarted"
      class="video-toggle-btn bg-secondary text-light px-4 py-2 rounded"
      (click)="toggleVideo()"
    >
      {{ isVideoOff ? "Turn Video On" : "Turn Video Off" }}
    </button>
  </div>
</div>
